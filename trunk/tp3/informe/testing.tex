\chapter{Testing}
En este apartado presentaremos el diseño, asi como también las cuestiones propias a la implementación y realización del testing funcional sobre la funcionalidad de registro de pedidos, para los casos donde hay a lo sumo un producto comestible y un producto del tipo bebida.

De acuerdo a nuestro modelo, esta funcionalidad esta encapsulada en una llamada al metodo ingresarPedido de la clase CoordinadorDePedidos.

\section{Analisis de factores, categorias y choices}
%basicamente poner las cosas de testing, hacer tablita, etc
Los inputs directos de la funcionalidad son:
\begin{itemize}
\item Cliente
\item Lista de productos
\item Forma de pago
\item Origen
\item Número de mesa
\end{itemize}

Hay algunas situaciones que por nuestra implementación no se pueden dar y que por lo tanto no seran tenidas en cuenta en las tablas a fin de que sean mas claras, por ejemplo que el cliente no exista no es algo que se tenga en cuenta, ya que para ingresar un pedido se elige un cliente de entre todos los clientes registrados, si en cambio hay que tener en cuenta el caso en el que no se eligió ningun cliente. Por ejemplo tampoco se testearan los casos donde el origen o la forma de pago sean invalidas, ya que la GUI no permite ingresar un origen distinto a los origenes validos.
 %chequear que sea asi
A su vez podemos considerar otros elementos del sistema que modifican el comportamiento de la funcionalidad y que deben ser tenidos en cuenta:
\begin{itemize}
\item Preparadores ocupados o no
\item ¿Hay pedidos en la cola de ingreso?
\item Stock de los insumos necesarios para el pedido
\item Insumos con cantidad critica
\end{itemize}

A continuación daremos una revisión de los diferentes factores, categorias y choices que tendremos en cuenta para diseñar el testing.

\subsection{Origen}
El origen es un factor a tener en cuenta, ya que según si el pedido es de mostrador, mesa o telefono, hay ciertos invariantes que se debe preservar para poder ingresar un pedido de este tipo. Por ejemplo un pedido de mesa debe tener una mesa asociada, un pedido telefonico debe tener un cliente asociado, etc. Entonces vemos que la categoria que nos importa del origen es su valor. Las choices son los distintos valores de origen: Mostrador, Mesa y Teléfono

\subsection{Número de mesa}
En el caso de que se pretenda ingresar un pedido de mesa, un factor a tener en cuenta es el número de mesa, en particular nos importa el valor, que puede ser nulo o no. Si es nulo, se debe generar un mensaje de error ya que el número es necesario. En el caso de que el pedido no sea de mesa, no lo consideraremos porque la GUI no permite ingresar un número de mesa cuando se intenta ingresar otro pedido.

\subsection{Cliente}
El cliente es otro factor a tener en cuenta. Como dijimos anteriormente, no consideraremos el caso en el que el cliente sea por ejemplo un cliente no registrado, ya que la GUI solo permite elegir a los clientes de una lista, mostrando los clientes registrados. Si consideraremos como categoria el valor del cliente en el sentido de si es nulo o no. En el caso de que el cliente sea nulo, si el pedido era telefonico, debe dar error.

\subsection{Lista de productos}
Otro factor a tener en cuenta es la lista de productos que componen al pedido. En particular una posible categoria a tener en cuenta es como esta compuesta. Por enunciado, nos limitaremos a una comida y una bebida. Entonces dentro de esta categoria consideraremos el caso donde la lista esta compuesta por 0 productos, condicion de error, una bebida, una comida o una bebida y una comida. El caso de una comida lo consideraremos como unico porque creemos que no presenta algun interese particular. Por otro lado el caso de una bebida también lo consideraremos como unico porque es un caso simple. La justificación es que creemos que el caso donde hay solo bebidas es simple de tratar, pero por una cuestión de completitud decidimos probarlo.

En los casos en los que hay una comida, nos va a interesar también que tipo de comida es, si pizza o empanada, ya que cada producto tiene por ejemplo su preparador asociado, etc.

\subsection{Forma de pago}
La forma de pago es un factor a tener en cuenta para los pedidos de mostrador que permiten escoger entre dos posibles: efectivo o tarjeta. Los demas origenes solo pemiten especificar una forma de pago: los de mesa, forma de pago nula (no se conoce hasta que se cierra la mesa) y los telefonicos mediante el efectivo.

Este factor también se tiene en cuenta por una cuestión de completitud, ya que en verdad no creemos que sea un posible foco de bugs, pòr esta razon consideraremos el caso efectivo como unico, a fin de que no nos aumenten demasiado la cantidad de casos.

\subsection{Relacion productos y stock}
En este factor tenemos varias cosas que considerar. En primer lugar la cantidad actual de los insumos en relación con la cantidad necesaria para satisfacer al pedido. Nosotros consideraremos los casos donde todos los insumos tienen menos stock que el necesario (condición de error), algunos tienen menos stock que el necesario (condición de error), algunos tienen un valor igual al necesario (y el resto mayor o igual) como caso unico para testear el caso borde, y finalmente el caso donde todos los insumos tienen una cantidad mayor a la necesaria.

Otra categoria a tener en cuenta es la cantidad actual de los insumos necesarios en función con su cantidad critica. Consideraremos el caso donde los todos los insumos estan en condición critica, algunos estan y otros no y finalmente el caso donde ninguno esta en estado critico. El caso todos y ninguno los trataremos como unicos por dos razones principales: mantener la cantidad de casos acotado, y porque el caso algunos parece mas general y abarcativo.

Una tercer categoria a tener en cuenta es si hay insumos que pasan de un estado normal a uno de stock critico, en cuyo caso de debera mostrar un mensaje informativo (notar que si ya estaban en estado critico, no se debe mostrar un mensaje).
Podemos considerar las choices: ninguno hace esta transición, alguno la hace y el resto queda en valores mas grandes que el critico, alguno la hace, algunos quedan en valores iguales al critico y el resto en valores mas grandes, y finalmente el caso donde todos realizan la transición. Estos dos ultimos casos los consideraremos como unicos.
%TODO:explicar un poco mas como se hace esto

\subsection{Cola de ingreso}
La cola de ingreso es también un factor a tener en cuenta. La categoria es su tamaño. Si bien mas que el tamaño, lo que importa para decidir si un pedido se encola o no es el estado del preparador, es por lo menos conveniente considerar con un caso unico cuando la cola esta vacia y separar el caso de cuando en la cola ya hay pedidos.

\subsection{Preparadores}
Los preparadores tienen importancia como factores, ya que son los que deciden para un pedido con comida si este se encola o se comienza a preparar. 

Entonces en los casos en los que el pedido sea de comida, utilizando el hecho de que solo se testean los pedidos con un unico item de comida, podemos considerar como categorias el estado del preparador asociado al tipo del producto y el del preparador del otro tipo de comida. Entonces podemos considerar los valores ocupado, y libre para cada uno de ellos. El preparador del otro tipo no deberia tener mucha importancia, pero podria ocurrir por ejemplo que si el preparador correcto esta ocupado y el otro libre se realice una asignacion erronea. Por eso lo consideramos, a fin de mantener la cantidad de casos en un número manejable, lo que haremos sera tomar el caso ocupado como unico


\newpage
\pagestyle{empty}
{
\fancypagestyle{plain}
    {
    \fancyhead{}
    \fancyfoot{}
    \renewcommand{\headrulewidth}{0.0pt}
    } % clear header and footer of plain page because of ToC
\begin{landscape}
\begin{tabular}{|c|c|c|c|}
\hline 
Factor & Categoria & Choice & Clasificacion\tabularnewline
\hline
\hline 
Origen & Valor & Mesa & \tabularnewline
 &  & Mostrador & \tabularnewline
 &  & Telefono & \tabularnewline
\hline 
Lista De Productos & Composición & 0 Productos & {[}Error]\tabularnewline
 &  & 1 Bebida & {[}Único]{[}Property hayBebida]\tabularnewline
 &  & 1 Comida & {[}Único]{[}Property hayComida]\tabularnewline
 &  & 1 Bebida y 1 Comida & {[}Property hayBebidaYComida]\tabularnewline
 & Cantidad de items de bebida & 1 & {[}Único]{[}if hayBebida or hayBebidaYComida]\tabularnewline
 &  & > 1 & {[}if hayBebida or hayBebidaYComida]\tabularnewline
 & Cantidad de items de comida & 1 & {[}Único] {[}if hayBebida or hayBebidaYComida]\tabularnewline
 &  & >1 & {[}if hayComida or hayBebidaYComida]\tabularnewline
 & Tipo de comida & Pizza & {[}if hayComida or hayBebidaYComida]\tabularnewline
 &  & Empanada & {[}if hayComida or hayBebidaYComida]\tabularnewline
\hline 
Mesa & Número de mesa & Si & {[}if Mesa]\tabularnewline
 &  & No & {[}if Mesa]{[}Error]\tabularnewline
 &  & Si & {[}if not Mesa]{[}Error]\tabularnewline
 &  & No & {[}if not Mesa]\tabularnewline
\hline 
Cliente & Valor & Nulo & {[}if not Telefono]{[}Error]\tabularnewline
 &  & No nulo & {[}if not Telefono]{[}Único]\tabularnewline
 &  & No nulo & {[}if Telefono]\tabularnewline
 &  & Nulo & {[}if Telefono]{[}Error]\tabularnewline
\hline 
Forma De Pago & Tipo & Nula & {[}if mesa]\tabularnewline
 &  & No Nula & {[}if mesa]{[}Error]\tabularnewline
 &  & Nula & {[}if not mesa]{[}Error]\tabularnewline
 &  & pertenece a {[}Tarjeta,Efectivo] & {[}if Mostrador]\tabularnewline
 &  & Tarjeta & {[}if Telefono]{[}Error]\tabularnewline
 &  & Efectivo & {[}if Telefono]\tabularnewline
\hline 
Relacion entre stock de bebida y los productos & Stock necesario vs cantActual & > cantActual & {[}Error]{[}if hayBebida or hayBebidaYComida]\tabularnewline
 &  & = cantActual & {[}Único]{[}if hayBebida or hayBebidaYComida]\tabularnewline
 &  & < cantActual & {[}if hayBebida or hayBebidaYComida]\tabularnewline
\hline 
Relacion entre stock de comida y los productos & Stock necesario vs cantActual & > cantACtual & {[}Error]{[}if hayComida or hayBebidaYComida]\tabularnewline
 &  & = cantActual & {[}if hayComida or hayBebidaYComida]\tabularnewline
 &  & < cantActual & {[}if hayComida or hayBebidaYComida]\tabularnewline
\hline 
Cola de ingreso & Cantidad de pedidos encolados & = 0 & {[}Único]\tabularnewline
 &  & > 0 & \tabularnewline
\hline 
Preparador asociado al tipo de comida & Ocupado & Si & \tabularnewline
 &  & No & \tabularnewline
\hline 
Preparador asociado al otro tipo de comida & Ocupado & Si & {[}Único]\tabularnewline
 &  & No & \tabularnewline
\hline 
Relacion insumos productos & Cantidad & Ninguno en cantidad critica & {[}Único]{[}Property Ninguno]\tabularnewline
 &  & Algunos (pero no todos) en cantidad critica & \tabularnewline
 &  & Todos en cantidad critica & {[}Único]\tabularnewline
\hline 
 & Cantidad vs cantidad necesaria & Ninguno queda en cantidad critica & {[}if Ninguno]\tabularnewline
 &  & Alguno queda en cantidad critica & \tabularnewline
 &  & Todos quedan en cantidad critica & {[}Único]\tabularnewline
\hline
\end{tabular}
\end{landscape}
}
\pagenumbering{arabic}
\fancypagestyle{plain} {
    \fancyhead[LO]{Gonzalez, Gonzalez, Martínez, Sainz-Trápaga}
    \fancyhead[C]{}
    \fancyhead[RO]{P\'agina \thepage\ de \pageref{LastPage}}
    \fancyfoot{}
    \renewcommand{\headrulewidth}{0.4pt}
}
\pagestyle{plain}

\subsection{Justificación}
En primer lugar consideramos el origen, ya que según si es de mesa, mostrador o telefonico, el comportamiento de la funcionaldiad varía.

El segundo factor que consideramos es la lista de productos. De esta, son varios los aspectos que nos interesan



\section{Diseño de los casos de test}
\begin{landscape}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline 
Origen & L de Prods & L de Prods & L de Prods & L de Prods & Mesa & Cliente & Pago & Rel stock B y los prods & Rel stock C y los prods & C Ing & Prep asoc & Prep & Rel Ins prods & Rel Ins prods & Resultado\tabularnewline
\hline
\hline 
Valor & Composición & Cant items B & Cant items C & Tipo de C & Nº & Valor & Tipo & nec vs actual & nec vs actual & Cant & Ocupado & Ocupado & Cant & cant vs nec & Esperado\tabularnewline
\hline
\hline 
- & 0 prods & - & - & - & - & - & - & - & - & - & - & - & - & - & Excepción ProductosVacios. Se muestra mensaje informando del error.
El pedido no queda registrado\tabularnewline
\hline 
Mesa & 1 B y 1 C & > 1 & > 1  & Pizza & No & - & - & - & - & - & - & - & - & - & Excepcion PedidoDeMesaSinMesa. Se muestra mensaje informando del error.
El pedido no queda registrado \tabularnewline
\hline 
Mesa & 1 B y 1 C & > 1 & > 1  & Pizza & Si & Nulo & No Nulo & - & - & - & - & - & - & - & Excepción TipoDePagoInvalido. Se notifica del error. El pedido no
se registra\tabularnewline
\hline 
Mesa & 1 B y 1 C & > 1 & > 1  & Pizza & Si & Nulo & Nulo & > cantActual & - & - & - & - & - & - & Excepción ProductoInsatisfacible. Se notifica que un prod no se pudo
satisfacer. El pedido no se registra\tabularnewline
\hline 
Mesa & 1 B y 1 C & > 1 & > 1  & Pizza & Si & Nulo & Nulo & < cantActual & > cantActual & - & - & - & - & - & Excepción ProductoInsatisfacible. Se notifica que un prod no se pudo
satisfacer. El pedido no se registra\tabularnewline
\hline 
Mesa & 1 B y 1 C & > 1 & > 1  & Pizza & Si & Nulo & Nulo & < cantActual & < cantActual & >0 & Si & No & Algunos & Alguno  & Se registra un pedido de mesa, con la mesa del input, con los productos
ingresados. Se encola al final de la cola de ingreso, en el horno
pizzero. Se decrementan los stocks de los insumos involucrados y se
actualiza la lista de stock para mostrar que algunos quedaron en stock
critico. Se estiman los tiempos y se calcula el precio de acuerdo
a lo especificado\tabularnewline
\hline 
Mesa & 1 B y 1 C & > 1 & > 1  & Pizza & Si & Nulo & Nulo & < cantActual & < cantActual & >0 & No & No & Algunos & Alguno & Se registra un pedido de mesa, con la mesa del input, con los productos
ingresados. Se notifica que la pizza debe comenzar a prepararse. Se
decrementan los stocks de los insumos involucrados y se actualiza
la lista de stock para mostrar que algunos quedaron en stock critico.
Se estiman los tiempos y se calcula el precio de acuerdo a lo especificado\tabularnewline
\hline 
Mesa & 1 B y 1 C & > 1 & > 1  & Empanada & Si & Nulo & Nulo & < cantActual & < cantActual & >0 & Si & No & Algunos & Alguno & Se registra un pedido de mesa, con la mesa del input, con los productos
ingresados. Se encola al final de la cola de ingreso, en el horno
empanadero. Se decrementan los stocks de los insumos involucrados
y se actualiza la lista de stock para mostrar que algunos quedaron
en stock critico. Se estiman los tiempos y se calcula el precio de
acuerdo a lo especificado\tabularnewline
\hline 
Mesa & 1 B y 1 C & > 1 & > 1  & Empanada & Si & Nulo & Nulo & < cantActual & < cantActual & >0 & No & No & Algunos & Alguno & Se registra un pedido de mesa, con la mesa del input, con los productos
ingresados. Se notifica que las empanadas debe comenzar a prepararse.
Se decrementan los stocks de los insumos involucrados y se actualiza
la lista de stock para mostrar que algunos quedaron en stock critico.
Se estiman los tiempos y se calcula el precio de acuerdo a lo especificado\tabularnewline
\hline 
Mesa & 1 B y 1 C & > 1 & > 1  & Empanada & Si & No Nulo & Nulo & < cantActual & < cantActual & >0 & No & No & Algunos & Alguno & Se registra un pedido de mesa, con la mesa del input, con los productos
ingresados. Se encola al final de la cola de ingreso, en el horno
empanadero. Se decrementan los stocks de los insumos involucrados
y se actualiza la lista de stock para mostrar que algunos quedaron
en stock critico. El cliente asociado es el Cliente del input. Se
estiman los tiempos y se calcula el precio de acuerdo a lo especificado\tabularnewline
\hline 
Mostrador & 1 B y 1 C & >1 & >1 & Empanada & Si & - & - & - & - & - & - & - & - & - & Excepcion PedidoDeMostradorConMesa. Se muestra un mensaje de error.
No se registra el pedido\tabularnewline
\hline 
Mostrador & 1 B y 1 C & > 1 & > 1  & Empanada & No & Nulo & Nulo & - & - & - & - & - & - & - & Excepcion TipoDePagoInvalido. Se muestra un mensaje informando de
la situación. El pedido no se registra\tabularnewline
\hline 
Mostrador & 1 B y 1 C & > 1 & > 1  & Empanada & No & Nulo & T o F & < cantActual & < cantActual & >0 & Si & No & Algunos & Alguno & Se registra un pedido de mostrador, con los productos ingresados.
Se encola en la cola de ingreso. Se decrementan los stocks de los
insumos involucrados y se actualiza la lista de stock para mostrar
que algunos quedaron en stock critico. Se estiman los tiempos y se
calcula el precio de acuerdo a lo especificado. Se asigna el horno
empanadero. La forma de pago es la del input\tabularnewline
\hline 
Mostrador & 1 B y 1 C & > 1 & > 1  & Empanada & No & Nulo & T o F & < cantActual & < cantActual & >0 & No & No & Algunos & Alguno & Se registra un pedido de mostrador, con los productos ingresados.
Se notifica que debe preparase. Se decrementan los stocks de los insumos
involucrados y se actualiza la lista de stock para mostrar que algunos
quedaron en stock critico. Se estiman los tiempos y se calcula el
precio de acuerdo a lo especificado. Se asigna el horno empanadero.
La forma de pago es la del input\tabularnewline
\hline 
Mostrador & 1 B y 1 C & > 1 & > 1  & Pizza & No & Nulo & T o F & < cantActual & < cantActual & >0 & Si & No & Algunos & Alguno & Se registra un pedido de mostrador, con los productos ingresados.
Se encola en la cola de ingreso. Se decrementan los stocks de los
insumos involucrados y se actualiza la lista de stock para mostrar
que algunos quedaron en stock critico. Se estiman los tiempos y se
calcula el precio de acuerdo a lo especificado. Se asigna el horno
pizzero. La forma de pago es la del input\tabularnewline
\hline 
Mostrador & 1 B y 1 C & > 1 & > 1  & Pizza & No & Nulo & T o F & < cantActual & < cantActual & >0 & No & No & Algunos & Alguno & Se registra un pedido de mostrador, con los productos ingresados.
Se notifica que debe preparase. Se decrementan los stocks de los insumos
involucrados y se actualiza la lista de stock para mostrar que algunos
quedaron en stock critico. Se estiman los tiempos y se calcula el
precio de acuerdo a lo especificado. Se asigna el horno pizzero. La
forma de pago es la del input\tabularnewline
\hline 
Telefono & 1 B y 1 C & > 1 & >1 & Empanada & No & Nulo & - & - & - & - & - & - & - & - & Excepcion Cliente Nulo. Se notifica mediante un mensaje. El pedido
no se registra\tabularnewline
\hline 
Telefono & 1 B y 1 C & > 1 & > 1  & Empanada & No & No nulo & Tarjeta & - & - & - & - & - & - & - & Excepcion TipoDePagoInvalido. Se muestra un mensaje informando la
situación. El pedido no queda registrado\tabularnewline
\hline 
Telefono & 1 B y 1 C & > 1 & > 1  & Empanada & No & No nulo & Efectivo & < cantActual & < cantActual & >0 & Si & No & Algunos & Alguno & Se registra un pedido telefonico, con los productos ingresados. Se
encola en la cola de ingreso. Se decrementan los stocks de los insumos
involucrados y se actualiza la lista de stock para mostrar que algunos
quedaron en stock critico. Se estiman los tiempos y se calcula el
precio de acuerdo a lo especificado. Se asigna el horno empanadero.
La forma de pago es la del input\tabularnewline
\hline 
Telefono & 1 B y 1 C & > 1 & > 1  & Empanada & No & No nulo & Efectivo & < cantActual & < cantActual & >0 & No & No & Algunos & Alguno & Se registra un pedido de mostrador, con los productos ingresados.
Se notifica que debe preparase. Se decrementan los stocks de los insumos
involucrados y se actualiza la lista de stock para mostrar que algunos
quedaron en stock critico. Se estiman los tiempos y se calcula el
precio de acuerdo a lo especificado. Se asigna el horno empanadero.
La forma de pago es la del input\tabularnewline
\hline 
Telefono & 1 B y 1 C & > 1 & > 1  & Pizza & No & No nulo & Efectivo & < cantActual & < cantActual & >0 & Si & No & Algunos & Alguno & Se registra un pedido de mostrador, con los productos ingresados.
Se encola en la cola de ingreso. Se decrementan los stocks de los
insumos involucrados y se actualiza la lista de stock para mostrar
que algunos quedaron en stock critico. Se estiman los tiempos y se
calcula el precio de acuerdo a lo especificado. Se asigna el horno
pizzero. La forma de pago es la del input\tabularnewline
\hline 
Telefono & 1 B y 1 C & > 1 & > 1  & Pizza & No & No nulo & Efectivo & < cantActual & < cantActual & >0 & No & No & Algunos & Alguno & Se registra un pedido de mostrador, con los productos ingresados.
Se notifica que debe preparase. Se decrementan los stocks de los insumos
involucrados y se actualiza la lista de stock para mostrar que algunos
quedaron en stock critico. Se estiman los tiempos y se calcula el
precio de acuerdo a lo especificado. Se asigna el horno pizzero. La
forma de pago es la del input\tabularnewline
\hline 
Mostrador & 1 Bebida & =1 & No aplica & No aplica & No & Nulo & Tarjeta & = cantActual & No aplica & >0 & No aplica & No aplica & Algunos & Alguno & Se registra el pedido de mostrador de solo bebidas. El pedido queda
en la cola de listos. Se decrementa el stock de la bebida. Se notifica
que hay stocks que quedan en stock critico. No se asigna horno. La
forma de pago es la del input. El tiempo estimado es 0. Se calcula
el precio\tabularnewline
\hline 
Telefono & 1 Comida & No aplica & =1  & Pizza & No & No Nulo & Efectivo & No aplica & = cantActua & =0 & Si & Si & Algunos & Alguno & Se registra el pedido. El pedido queda en la cola de ingreso. Se decrementa
el stock de la comida. Se notifica que hay stocks que quedan en stock
critico. Se asigna el horno pizzero. La forma de pago es la del input.
Se estima el tiempo y se calcula el precio\tabularnewline
\hline
\hline 
Mostrador  & 1 B y 1 C & > 1  & > 1  & Empanada & No  & Nulo & Efectivo & < cantActual & < cantActual & >0 & No & Si & Ninguno & Ninguno & Se registra el pedido. Se notifica que hay que preparar las empanadas.
Se decrementa el stock de la comida. No se notifican nuevos productos
en stock critico. Se asigna el horno empanadero. La forma de pago
es la del input. Se estima el tiempo y se calcula el precio.\tabularnewline
\hline
\hline 
Mostrador  & 1 B y 1 C & > 1  & > 1  & Empanada & No  & Nulo & Efectivo & < cantActual & < cantActual & >0 & No & Si & Todos & Todos & Se registra el pedido. Se notifica que hay que preparar las empanadas.
Se decrementa el stock de la comida. Se notifican productos en stock
critico. Se asigna el horno empanadero. La forma de pago es la del
input. Se estima el tiempo y se calcula el precio.\tabularnewline
\hline
\end{tabular}
\end{landscape}

\section{Realización del testing}
%contar algo de como se hicieron los test, onda valores para las instancias, resultados, etc. se puede hacer una tabla
